{"version":3,"file":"fields.js","mappings":"YAAA,IAAWA,EAGLC,EAHKD,EA6IRE,OA1IGD,EAAcE,QAAQC,KAAKC,OAAO,CACpCC,QAAS,KACTC,eAAgB,KAEhBC,KAAM,WAAY,IAAAC,EAAA,KAChBC,KAAKJ,QAAUN,EAAE,WACjBU,KAAKH,eAAiBG,KAAKJ,QAAQK,KAAK,eACxCD,KAAKE,YAAYZ,EAAE,gBAAiB,WAAY,eAEhD,IAAIa,EAAoBb,EAAE,qBAEtBa,EAAkBC,SACND,EAAkBE,KAAK,WAE7BC,SAASC,eAAiB,SAACC,GAGjC,OAFalB,EAAEkB,GAAMH,KAAK,WAGxB,IAAK,SACHN,EAAKU,sBACL,MAEF,IAAK,SACHV,EAAKW,sBAIX,EAEJ,EAEAC,YAAa,WAAY,IAAAC,EAAA,KACnBC,EAAOb,KAAKc,mBAAmB,IAEnC,GAAID,EAAM,CACR,IAAIR,EAAO,CACTQ,KAAMA,GAGRE,MAAMC,kBAAkB,OAAQ,oBAAqB,CAACX,KAAAA,IACnDY,MAAK,SAACC,GACLC,SAASC,KAAOL,MAAMM,OACpB,mBAAqBH,EAASb,KAAKiB,MAAMC,GAE7C,IAAE,OACK,SAAAC,GAAgB,IAAdN,EAAQM,EAARN,SACP,GAAIA,EAASb,KAAKoB,OAAQ,CACxB,IAAIA,EAASb,EAAKc,cAAcR,EAASb,KAAKoB,QAC9CV,MAAMY,GAAGC,aACPb,MAAMc,EAAE,MAAO,+BACb,OACAJ,EAAOK,KAAK,MAElB,MACEf,MAAMY,GAAGC,cAEb,GACJ,CACF,EAEAnB,oBAAqB,WAAY,IAAAsB,EAAA,KAC3BC,EAAUhC,KAAKH,eAAeoC,OAChCC,EAAUlC,KAAKc,mBAAmBkB,GAEpC,GAAIE,GAAWA,IAAYF,EAAS,CAClC,IAAI3B,EAAO,CACTkB,GAAIvB,KAAKH,eAAeQ,KAAK,MAC7BQ,KAAMqB,GAGRnB,MAAMC,kBAAkB,OAAQ,oBAAqB,CAACX,KAAAA,IACnDY,MAAK,SAACC,GACLa,EAAKlC,eAAeoC,KAAKf,EAASb,KAAKiB,MAAMT,MAC7CE,MAAMY,GAAGQ,eAAepB,MAAMc,EAAE,MAAO,kBACzC,IAAE,OACK,SAAAO,GAAgB,IAAdlB,EAAQkB,EAARlB,SACP,GAAIA,EAASb,KAAKoB,OAAQ,CACxB,IAAIA,EAASM,EAAKL,cAAcR,EAASb,KAAKoB,QAC9CV,MAAMY,GAAGC,aACPb,MAAMc,EAAE,MAAO,+BACb,OACAJ,EAAOK,KAAK,MAElB,MACEf,MAAMY,GAAGC,cAEb,GACJ,CACF,EAEAd,mBAAoB,SAAUkB,GAC5B,OAAOK,OACLtB,MAAMc,EAAE,MAAO,uCACfG,EAEJ,EAEAtB,oBAAqB,WACnB,GACE4B,QACEvB,MAAMc,EACJ,MACA,mEAGJ,CACA,IAAIxB,EAAO,CACTkB,GAAIvB,KAAKH,eAAeQ,KAAK,OAG/BU,MAAMC,kBAAkB,OAAQ,sBAAuB,CAACX,KAAAA,IACrDY,MAAK,SAACC,GACLC,SAASC,KAAOL,MAAMM,OAAO,kBAC/B,IAAE,OACK,SAAAkB,GAAUA,EAARrB,SACPH,MAAMY,GAAGC,cACX,GACJ,CACF,EAEAF,cAAe,SAAUc,GACvB,IAAIf,EAAS,GAEb,IAAK,IAAIgB,KAAaD,EACfA,EAAeE,eAAeD,KAInChB,EAASA,EAAOkB,OAAOH,EAAeC,KAGxC,OAAOhB,CACT,IAGFhC,QAAQmD,KAAKC,OAAM,WACjB9B,MAAMxB,YAAc,IAAIA,CAC1B,G","sources":["webpack:///./fields.js"],"sourcesContent":["(function ($) {\n  /** global: Craft */\n  /** global: Garnish */\n  var FieldsAdmin = Garnish.Base.extend({\n    $groups: null,\n    $selectedGroup: null,\n\n    init: function () {\n      this.$groups = $('#groups');\n      this.$selectedGroup = this.$groups.find('a.sel:first');\n      this.addListener($('#newgroupbtn'), 'activate', 'addNewGroup');\n\n      var $groupSettingsBtn = $('#groupsettingsbtn');\n\n      if ($groupSettingsBtn.length) {\n        var menuBtn = $groupSettingsBtn.data('menubtn');\n\n        menuBtn.settings.onOptionSelect = (elem) => {\n          var action = $(elem).data('action');\n\n          switch (action) {\n            case 'rename': {\n              this.renameSelectedGroup();\n              break;\n            }\n            case 'delete': {\n              this.deleteSelectedGroup();\n              break;\n            }\n          }\n        };\n      }\n    },\n\n    addNewGroup: function () {\n      var name = this.promptForGroupName('');\n\n      if (name) {\n        var data = {\n          name: name,\n        };\n\n        Craft.sendActionRequest('POST', 'fields/save-group', {data})\n          .then((response) => {\n            location.href = Craft.getUrl(\n              'settings/fields/' + response.data.group.id\n            );\n          })\n          .catch(({response}) => {\n            if (response.data.errors) {\n              var errors = this.flattenErrors(response.data.errors);\n              Craft.cp.displayError(\n                Craft.t('app', 'Could not create the group:') +\n                  '\\n\\n' +\n                  errors.join('\\n')\n              );\n            } else {\n              Craft.cp.displayError();\n            }\n          });\n      }\n    },\n\n    renameSelectedGroup: function () {\n      var oldName = this.$selectedGroup.text(),\n        newName = this.promptForGroupName(oldName);\n\n      if (newName && newName !== oldName) {\n        var data = {\n          id: this.$selectedGroup.data('id'),\n          name: newName,\n        };\n\n        Craft.sendActionRequest('POST', 'fields/save-group', {data})\n          .then((response) => {\n            this.$selectedGroup.text(response.data.group.name);\n            Craft.cp.displaySuccess(Craft.t('app', 'Group renamed.'));\n          })\n          .catch(({response}) => {\n            if (response.data.errors) {\n              var errors = this.flattenErrors(response.data.errors);\n              Craft.cp.displayError(\n                Craft.t('app', 'Could not rename the group:') +\n                  '\\n\\n' +\n                  errors.join('\\n')\n              );\n            } else {\n              Craft.cp.displayError();\n            }\n          });\n      }\n    },\n\n    promptForGroupName: function (oldName) {\n      return prompt(\n        Craft.t('app', 'What do you want to name the group?'),\n        oldName\n      );\n    },\n\n    deleteSelectedGroup: function () {\n      if (\n        confirm(\n          Craft.t(\n            'app',\n            'Are you sure you want to delete this group and all its fields?'\n          )\n        )\n      ) {\n        var data = {\n          id: this.$selectedGroup.data('id'),\n        };\n\n        Craft.sendActionRequest('POST', 'fields/delete-group', {data})\n          .then((response) => {\n            location.href = Craft.getUrl('settings/fields');\n          })\n          .catch(({response}) => {\n            Craft.cp.displayError();\n          });\n      }\n    },\n\n    flattenErrors: function (responseErrors) {\n      var errors = [];\n\n      for (var attribute in responseErrors) {\n        if (!responseErrors.hasOwnProperty(attribute)) {\n          continue;\n        }\n\n        errors = errors.concat(responseErrors[attribute]);\n      }\n\n      return errors;\n    },\n  });\n\n  Garnish.$doc.ready(function () {\n    Craft.FieldsAdmin = new FieldsAdmin();\n  });\n})(jQuery);\n"],"names":["$","FieldsAdmin","jQuery","Garnish","Base","extend","$groups","$selectedGroup","init","_this","this","find","addListener","$groupSettingsBtn","length","data","settings","onOptionSelect","elem","renameSelectedGroup","deleteSelectedGroup","addNewGroup","_this2","name","promptForGroupName","Craft","sendActionRequest","then","response","location","href","getUrl","group","id","_ref","errors","flattenErrors","cp","displayError","t","join","_this3","oldName","text","newName","displaySuccess","_ref2","prompt","confirm","_ref3","responseErrors","attribute","hasOwnProperty","concat","$doc","ready"],"sourceRoot":""}