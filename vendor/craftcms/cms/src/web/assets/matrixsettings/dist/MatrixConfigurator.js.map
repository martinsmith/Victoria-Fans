{"version":3,"file":"MatrixConfigurator.js","mappings":"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","sources":["webpack:///./MatrixConfigurator.js"],"sourcesContent":["(function ($) {\n  /** global: Craft */\n  /** global: Garnish */\n  /**\n   * Matrix configurator class\n   */\n  Craft.MatrixConfigurator = Garnish.Base.extend({\n    fieldTypeInfo: null,\n\n    inputNamePrefix: null,\n    fieldTypeSettingsNamespace: null,\n    inputIdPrefix: null,\n    placeholderKey: null,\n\n    $container: null,\n\n    $blockTypesColumnContainer: null,\n    $fieldsColumnContainer: null,\n    $fieldSettingsColumnContainer: null,\n\n    $blockTypeItemsOuterContainer: null,\n    $blockTypeItemsContainer: null,\n    $fieldItemsContainer: null,\n    $fieldSettingItemsContainer: null,\n\n    $newBlockTypeBtn: null,\n    $newFieldBtn: null,\n\n    blockTypes: null,\n    selectedBlockType: null,\n    blockTypeSort: null,\n    totalNewBlockTypes: 0,\n\n    _fieldTypeSettingsHtml: null,\n    _cancelToken: null,\n    _ignoreFailedRequest: false,\n\n    init: function (\n      fieldTypeInfo,\n      inputNamePrefix,\n      fieldTypeSettingsNamespace,\n      placeholderKey\n    ) {\n      this.fieldTypeInfo = fieldTypeInfo;\n      this.inputNamePrefix = inputNamePrefix;\n      this.fieldTypeSettingsNamespace = fieldTypeSettingsNamespace;\n      this.inputIdPrefix = Craft.formatInputId(this.inputNamePrefix);\n      this.placeholderKey = placeholderKey;\n\n      this.$container = $(\n        '#' + this.inputIdPrefix + '-matrix-configurator:first .input:first'\n      );\n\n      this.$blockTypesColumnContainer = this.$container\n        .children('.block-types')\n        .children();\n      this.$fieldsColumnContainer = this.$container\n        .children('.mc-fields')\n        .children();\n      this.$fieldSettingsColumnContainer = this.$container\n        .children('.mc-field-settings')\n        .children();\n\n      this.$blockTypeItemsOuterContainer =\n        this.$blockTypesColumnContainer.children('.mc-col-items');\n      this.$blockTypeItemsContainer =\n        this.$blockTypeItemsOuterContainer.children('.mc-blocktypes');\n      this.$fieldItemsOuterContainer =\n        this.$fieldsColumnContainer.children('.mc-col-items');\n      this.$fieldSettingItemsContainer =\n        this.$fieldSettingsColumnContainer.children('.mc-col-items');\n\n      this.$newBlockTypeBtn =\n        this.$blockTypeItemsOuterContainer.children('.btn');\n      this.$newFieldBtn = this.$fieldItemsOuterContainer.children('.btn');\n\n      this._fieldTypeSettingsHtml = {};\n\n      // Find the existing block types\n      this.blockTypes = {};\n\n      var $blockTypeItems = this.$blockTypeItemsContainer.children();\n\n      for (var i = 0; i < $blockTypeItems.length; i++) {\n        var $item = $($blockTypeItems[i]),\n          id = $item.data('id');\n\n        this.blockTypes[id] = new BlockType(this, $item);\n\n        // Is this a new block type?\n        var newMatch = typeof id === 'string' && id.match(/new(\\d+)/);\n\n        if (newMatch && newMatch[1] > this.totalNewBlockTypes) {\n          this.totalNewBlockTypes = parseInt(newMatch[1]);\n        }\n      }\n\n      this.blockTypeSort = new Garnish.DragSort($blockTypeItems, {\n        handle: '.move',\n        axis: 'y',\n      });\n\n      this.addListener(this.$newBlockTypeBtn, 'click', 'addBlockType');\n      this.addListener(\n        this.$newFieldBtn,\n        'click',\n        'addFieldToSelectedBlockType'\n      );\n    },\n\n    getFieldTypeInfo: function (type) {\n      for (var i = 0; i < this.fieldTypeInfo.length; i++) {\n        if (this.fieldTypeInfo[i].type === type) {\n          return this.fieldTypeInfo[i];\n        }\n      }\n    },\n\n    addBlockType: function () {\n      this.getBlockTypeSettingsModal();\n\n      this.blockTypeSettingsModal.show();\n\n      this.blockTypeSettingsModal.onSubmit = (name, handle) => {\n        this.totalNewBlockTypes++;\n        var id = 'new' + this.totalNewBlockTypes;\n\n        var $item = $(\n          '<div class=\"matrixconfigitem mci-blocktype\" data-id=\"' +\n            id +\n            '\">' +\n            '<div class=\"mci-name\">' +\n            '<h4></h4>' +\n            '<div class=\"smalltext light code\"></div>' +\n            '</div>' +\n            '<a class=\"settings icon\" title=\"' +\n            Craft.t('app', 'Settings') +\n            '\"></a>' +\n            '<a class=\"move icon\" title=\"' +\n            Craft.t('app', 'Reorder') +\n            '\"></a>' +\n            '<input class=\"hidden\" name=\"' +\n            this.inputNamePrefix +\n            '[blockTypes][' +\n            id +\n            '][name]\">' +\n            '<input class=\"hidden\" name=\"' +\n            this.inputNamePrefix +\n            '[blockTypes][' +\n            id +\n            '][handle]\">' +\n            '</div>'\n        ).appendTo(this.$blockTypeItemsContainer);\n\n        this.blockTypes[id] = new BlockType(this, $item);\n        this.blockTypes[id].applySettings(name, handle);\n        this.blockTypes[id].select();\n        this.blockTypes[id].addField();\n\n        this.blockTypeSort.addItems($item);\n      };\n    },\n\n    addFieldToSelectedBlockType: function () {\n      if (this.selectedBlockType) {\n        this.selectedBlockType.addField();\n      }\n    },\n\n    getBlockTypeSettingsModal: function () {\n      if (!this.blockTypeSettingsModal) {\n        this.blockTypeSettingsModal = new BlockTypeSettingsModal();\n      }\n\n      return this.blockTypeSettingsModal;\n    },\n\n    getFieldTypeSettingsHtml: function (type) {\n      return new Promise((resolve, reject) => {\n        if (typeof this._fieldTypeSettingsHtml[type] !== 'undefined') {\n          resolve(this._fieldTypeSettingsHtml[type]);\n          return;\n        }\n\n        // Cancel the current request\n        if (this._cancelToken) {\n          this._ignoreFailedRequest = true;\n          this._cancelToken.cancel();\n          Garnish.requestAnimationFrame(() => {\n            this._ignoreFailedRequest = false;\n          });\n        }\n\n        // Create a cancel token\n        this._cancelToken = axios.CancelToken.source();\n\n        Craft.sendActionRequest('POST', 'fields/render-settings', {\n          cancelToken: this._cancelToken.token,\n          data: {\n            type: type,\n            namespace: this.fieldTypeSettingsNamespace,\n          },\n        })\n          .then((response) => {\n            this._fieldTypeSettingsHtml[type] = response.data;\n            resolve(response.data);\n          })\n          .catch((e) => {\n            if (!this._ignoreFailedRequest) {\n              Craft.cp.displayError(e?.response?.data?.message);\n            }\n            reject();\n          });\n      });\n    },\n  });\n\n  /**\n   * Block type settings modal class\n   */\n  var BlockTypeSettingsModal = Garnish.Modal.extend({\n    init: function () {\n      this.base();\n\n      this.$form = $('<form class=\"modal fitted\"/>').appendTo(Garnish.$bod);\n      this.setContainer(this.$form);\n\n      this.$body = $('<div class=\"body\"/>').appendTo(this.$form);\n      let $nameField = Craft.ui\n        .createTextField({\n          label: Craft.t('app', 'Name'),\n          instructions: Craft.t(\n            'app',\n            'What this block type will be called in the control panel.'\n          ),\n        })\n        .appendTo(this.$body);\n      let $nameInputContainer = $nameField.find('.input');\n      this.$nameInput = $nameInputContainer.find('.text');\n      this.$nameErrorList = $('<ul class=\"errors\"/>')\n        .appendTo($nameInputContainer)\n        .hide();\n      let $handleField = Craft.ui\n        .createTextField({\n          label: Craft.t('app', 'Handle'),\n          instructions: Craft.t(\n            'app',\n            'How you’ll refer to this block type in the templates.'\n          ),\n          class: 'code',\n          maxlength: 47,\n        })\n        .appendTo(this.$body);\n      let $handleInputContainer = $handleField.find('.input');\n      this.$handleInput = $handleInputContainer.find('.text');\n      this.$handleErrorList = $('<ul class=\"errors\"/>')\n        .appendTo($handleInputContainer)\n        .hide();\n      this.$deleteBtn = $(\n        '<a class=\"error left hidden\" style=\"line-height: 30px;\">' +\n          Craft.t('app', 'Delete') +\n          '</a>'\n      ).appendTo(this.$body);\n      this.$buttons = $(\n        '<div class=\"buttons right\" style=\"margin-top: 0;\"/>'\n      ).appendTo(this.$body);\n      this.$cancelBtn = $('<button/>', {\n        type: 'button',\n        class: 'btn',\n        text: Craft.t('app', 'Cancel'),\n      }).appendTo(this.$buttons);\n      this.$submitBtn = $('<button/>', {\n        type: 'submit',\n        class: 'btn submit',\n      }).appendTo(this.$buttons);\n\n      this.handleGenerator = new Craft.HandleGenerator(\n        this.$nameInput,\n        this.$handleInput\n      );\n\n      this.addListener(this.$cancelBtn, 'click', 'hide');\n      this.addListener(this.$form, 'submit', 'onFormSubmit');\n      this.addListener(this.$deleteBtn, 'click', 'onDeleteClick');\n    },\n\n    onFormSubmit: function (ev) {\n      ev.preventDefault();\n\n      // Prevent multi form submits with the return key\n      if (!this.visible) {\n        return;\n      }\n\n      if (this.handleGenerator.listening) {\n        // Give the handle a chance to catch up with the input\n        this.handleGenerator.updateTarget();\n      }\n\n      // Basic validation\n      const name = this.$nameInput.val().trim();\n      const handle = this.$handleInput.val().trim();\n\n      if (!name || !handle) {\n        Garnish.shake(this.$form);\n      } else {\n        this.hide();\n        this.onSubmit(name, handle);\n      }\n    },\n\n    onDeleteClick: function () {\n      if (\n        confirm(\n          Craft.t('app', 'Are you sure you want to delete this block type?')\n        )\n      ) {\n        this.hide();\n        this.onDelete();\n      }\n    },\n\n    show: function (name, handle, errors) {\n      this.$nameInput.val(typeof name === 'string' ? name : '');\n      this.$handleInput.val(typeof handle === 'string' ? handle : '');\n\n      if (!handle) {\n        this.handleGenerator.startListening();\n      } else {\n        this.handleGenerator.stopListening();\n      }\n\n      if (typeof name === 'undefined') {\n        this.$deleteBtn.addClass('hidden');\n        this.$submitBtn.text(Craft.t('app', 'Create'));\n      } else {\n        this.$deleteBtn.removeClass('hidden');\n        this.$submitBtn.text(Craft.t('app', 'Apply'));\n      }\n\n      this.displayErrors('name', errors ? errors.name : null);\n      this.displayErrors('handle', errors ? errors.handle : null);\n\n      if (!Garnish.isMobileBrowser()) {\n        setTimeout(() => {\n          this.$nameInput.focus();\n        }, 100);\n      }\n\n      this.base();\n    },\n\n    displayErrors: function (attr, errors) {\n      var $input = this['$' + attr + 'Input'],\n        $errorList = this['$' + attr + 'ErrorList'];\n\n      $errorList.children().remove();\n\n      if (errors) {\n        $input.addClass('error');\n        $errorList.show();\n\n        for (var i = 0; i < errors.length; i++) {\n          $('<li/>').text(errors[i]).appendTo($errorList);\n        }\n      } else {\n        $input.removeClass('error');\n        $errorList.hide();\n      }\n    },\n  });\n\n  /**\n   * Block type class\n   */\n  var BlockType = Garnish.Base.extend({\n    configurator: null,\n    id: null,\n    errors: null,\n\n    inputNamePrefix: null,\n    inputIdPrefix: null,\n\n    $item: null,\n    $nameLabel: null,\n    $handleLabel: null,\n    $nameHiddenInput: null,\n    $handleHiddenInput: null,\n    $settingsBtn: null,\n    $fieldItemsContainer: null,\n    $fieldSettingsContainer: null,\n\n    fields: null,\n    selectedField: null,\n    fieldSort: null,\n    totalNewFields: 0,\n    fieldSettings: null,\n\n    init: function (configurator, $item) {\n      this.configurator = configurator;\n      this.$item = $item;\n      this.id = this.$item.data('id');\n      this.errors = this.$item.data('errors');\n\n      this.inputNamePrefix =\n        this.configurator.inputNamePrefix + '[blockTypes][' + this.id + ']';\n      this.inputIdPrefix =\n        this.configurator.inputIdPrefix + '-blockTypes-' + this.id;\n\n      let $nameContainer = this.$item.children('.mci-name');\n      this.$nameLabel = $nameContainer.children('h4');\n      this.$handleLabel = $nameContainer.children('.smalltext');\n      this.$nameHiddenInput = this.$item.find('input[name$=\"[name]\"]:first');\n      this.$handleHiddenInput = this.$item.find(\n        'input[name$=\"[handle]\"]:first'\n      );\n      this.$settingsBtn = this.$item.find('.settings');\n\n      // Find the field items container if it exists, otherwise create it\n      this.$fieldItemsContainer =\n        this.configurator.$fieldItemsOuterContainer.children(\n          '[data-id=\"' + this.id + '\"]:first'\n        );\n\n      if (!this.$fieldItemsContainer.length) {\n        this.$fieldItemsContainer = $(\n          '<div data-id=\"' + this.id + '\"/>'\n        ).insertBefore(this.configurator.$newFieldBtn);\n      }\n\n      // Find the field settings container if it exists, otherwise create it\n      this.$fieldSettingsContainer =\n        this.configurator.$fieldSettingItemsContainer.children(\n          '[data-id=\"' + this.id + '\"]:first'\n        );\n\n      if (!this.$fieldSettingsContainer.length) {\n        this.$fieldSettingsContainer = $(\n          '<div data-id=\"' + this.id + '\"/>'\n        ).appendTo(this.configurator.$fieldSettingItemsContainer);\n      }\n\n      // Find the existing fields\n      this.fields = {};\n\n      var $fieldItems = this.$fieldItemsContainer.children();\n\n      for (var i = 0; i < $fieldItems.length; i++) {\n        var $fieldItem = $($fieldItems[i]),\n          id = $fieldItem.data('id');\n\n        this.fields[id] = new Field(this.configurator, this, $fieldItem);\n\n        // Is this a new field?\n        var newMatch = typeof id === 'string' && id.match(/new(\\d+)/);\n\n        if (newMatch && newMatch[1] > this.totalNewFields) {\n          this.totalNewFields = parseInt(newMatch[1]);\n        }\n      }\n\n      this.addListener(this.$item, 'click', 'select');\n      this.addListener(this.$settingsBtn, 'click', 'showSettings');\n\n      this.fieldSort = new Garnish.DragSort($fieldItems, {\n        handle: '.move',\n        axis: 'y',\n        onSortChange: () => {\n          // Adjust the field setting containers to match the new sort order\n          for (var i = 0; i < this.fieldSort.$items.length; i++) {\n            var $item = $(this.fieldSort.$items[i]),\n              id = $item.data('id'),\n              field = this.fields[id];\n\n            field.$fieldSettingsContainer.appendTo(\n              this.$fieldSettingsContainer\n            );\n          }\n        },\n      });\n    },\n\n    select: function () {\n      if (this.configurator.selectedBlockType === this) {\n        return;\n      }\n\n      if (this.configurator.selectedBlockType) {\n        this.configurator.selectedBlockType.deselect();\n      }\n\n      this.configurator.$fieldsColumnContainer.removeClass('hidden');\n      this.$fieldItemsContainer.removeClass('hidden');\n      this.$item.addClass('sel');\n      this.configurator.selectedBlockType = this;\n      Garnish.$win.trigger('resize');\n    },\n\n    deselect: function () {\n      this.$item.removeClass('sel');\n      this.configurator.$fieldsColumnContainer.addClass('hidden');\n      this.$fieldItemsContainer.addClass('hidden');\n      this.$fieldSettingsContainer.addClass('hidden');\n      this.configurator.selectedBlockType = null;\n\n      if (this.selectedField) {\n        this.selectedField.deselect();\n      }\n\n      Garnish.$win.trigger('resize');\n    },\n\n    showSettings: function () {\n      var blockTypeSettingsModal =\n        this.configurator.getBlockTypeSettingsModal();\n      blockTypeSettingsModal.show(\n        this.$nameHiddenInput.val(),\n        this.$handleHiddenInput.val(),\n        this.errors\n      );\n      blockTypeSettingsModal.onSubmit = this.applySettings.bind(this);\n      blockTypeSettingsModal.onDelete = this.selfDestruct.bind(this);\n    },\n\n    applySettings: function (name, handle) {\n      if (this.errors) {\n        this.errors = null;\n        this.$settingsBtn.removeClass('error');\n      }\n\n      this.$nameLabel.attr('title', name).text(name);\n      this.$handleLabel.attr('title', handle).text(handle);\n      this.$nameHiddenInput.val(name);\n      this.$handleHiddenInput.val(handle);\n    },\n\n    addField: function () {\n      this.totalNewFields++;\n      var id = 'new' + this.totalNewFields;\n\n      var $item = $(\n        '<div class=\"matrixconfigitem mci-field\" data-id=\"' +\n          id +\n          '\">' +\n          '<div class=\"mci-name\">' +\n          '<h4><em class=\"light\">' +\n          Craft.t('app', '(blank)') +\n          '</em></h4>' +\n          '<div class=\"smalltext light code\"></div>' +\n          '</div>' +\n          '<div class=\"actions\">' +\n          '<a class=\"move icon\" title=\"' +\n          Craft.t('app', 'Reorder') +\n          '\"></a>' +\n          '</div>' +\n          '</div>'\n      ).appendTo(this.$fieldItemsContainer);\n\n      this.fields[id] = new Field(this.configurator, this, $item);\n      this.fields[id].select();\n\n      this.fieldSort.addItems($item);\n    },\n\n    selfDestruct: function () {\n      this.deselect();\n      this.$item.remove();\n      this.$fieldItemsContainer.remove();\n      this.$fieldSettingsContainer.remove();\n\n      this.configurator.blockTypes[this.id] = null;\n      delete this.configurator.blockTypes[this.id];\n    },\n  });\n\n  var Field = Garnish.Base.extend({\n    configurator: null,\n    blockType: null,\n    id: null,\n\n    inputNamePrefix: null,\n    inputIdPrefix: null,\n\n    selectedFieldType: null,\n    initializedFieldTypeSettings: null,\n\n    $item: null,\n    $nameLabel: null,\n    $handleLabel: null,\n\n    $fieldSettingsContainer: null,\n    $nameInput: null,\n    $handleInput: null,\n    $requiredCheckbox: null,\n    $typeSelect: null,\n    $translationSettingsContainer: null,\n    $typeSettingsContainer: null,\n    $widthInput: null,\n    $deleteBtn: null,\n\n    init: function (configurator, blockType, $item) {\n      this.configurator = configurator;\n      this.blockType = blockType;\n      this.$item = $item;\n      this.id = this.$item.data('id');\n\n      this.inputNamePrefix =\n        this.blockType.inputNamePrefix + '[fields][' + this.id + ']';\n      this.inputIdPrefix = this.blockType.inputIdPrefix + '-fields-' + this.id;\n\n      this.initializedFieldTypeSettings = {};\n      this.fieldTypeSettingsTemplates = {};\n\n      let $nameContainer = this.$item.children('.mci-name');\n      this.$nameLabel = $nameContainer.children('h4');\n      this.$handleLabel = $nameContainer.children('.smalltext');\n\n      // Find the field settings container if it exists, otherwise create it\n      this.$fieldSettingsContainer =\n        this.blockType.$fieldSettingsContainer.children(\n          '[data-id=\"' + this.id + '\"]:first'\n        );\n\n      var isNew = !this.$fieldSettingsContainer.length;\n\n      if (isNew) {\n        this.$fieldSettingsContainer = this.getDefaultFieldSettings().appendTo(\n          this.blockType.$fieldSettingsContainer\n        );\n      }\n\n      this.$nameInput = $('#' + this.inputIdPrefix + '-name');\n      this.$handleInput = $('#' + this.inputIdPrefix + '-handle');\n      this.$requiredCheckbox = $('#' + this.inputIdPrefix + '-required');\n      this.$typeSelect = $('#' + this.inputIdPrefix + '-type');\n      this.$translationSettingsContainer = $(\n        '#' + this.inputIdPrefix + '-translation-settings'\n      );\n      this.$typeSettingsContainer = this.$fieldSettingsContainer.children(\n        '.mc-fieldtype-settings:first'\n      );\n      this.$widthInput = $('#' + this.inputIdPrefix + '-width');\n      this.$deleteBtn = this.$fieldSettingsContainer.children('a.delete:first');\n\n      if (isNew) {\n        this.setFieldType('craft\\\\fields\\\\PlainText');\n      } else {\n        this.selectedFieldType = this.$typeSelect.val();\n        this.initializedFieldTypeSettings[this.selectedFieldType] =\n          this.$typeSettingsContainer.children();\n      }\n\n      if (!this.$handleInput.val()) {\n        new Craft.HandleGenerator(this.$nameInput, this.$handleInput);\n      }\n\n      this.addListener(this.$item, 'click', 'select');\n      this.addListener(this.$nameInput, 'input', 'updateNameLabel');\n      this.addListener(this.$handleInput, 'input', 'updateHandleLabel');\n      this.addListener(this.$requiredCheckbox, 'change', 'updateRequiredIcon');\n      this.addListener(this.$typeSelect, 'change', 'onTypeSelectChange');\n      this.addListener(this.$deleteBtn, 'click', 'confirmDelete');\n\n      let widthSlider = new Craft.SlidePicker(this.$widthInput.val() || 100, {\n        min: 25,\n        max: 100,\n        step: 25,\n        valueLabel: (width) => {\n          return Craft.t('app', '{pct} width', {pct: `${width}%`});\n        },\n        onChange: (width) => {\n          this.$widthInput.val(width);\n        },\n      });\n      widthSlider.$container.insertAfter($nameContainer);\n    },\n\n    select: function () {\n      if (this.blockType.selectedField === this) {\n        return;\n      }\n\n      if (this.blockType.selectedField) {\n        this.blockType.selectedField.deselect();\n      }\n\n      this.configurator.$fieldSettingsColumnContainer.removeClass('hidden');\n      this.blockType.$fieldSettingsContainer.removeClass('hidden');\n      this.$fieldSettingsContainer.removeClass('hidden');\n      this.$item.addClass('sel');\n      this.blockType.selectedField = this;\n      Garnish.$win.trigger('resize');\n\n      if (!Garnish.isMobileBrowser()) {\n        setTimeout(() => {\n          this.$nameInput.focus();\n        }, 100);\n      }\n    },\n\n    deselect: function () {\n      this.$item.removeClass('sel');\n      this.configurator.$fieldSettingsColumnContainer.addClass('hidden');\n      this.blockType.$fieldSettingsContainer.addClass('hidden');\n      this.$fieldSettingsContainer.addClass('hidden');\n      this.blockType.selectedField = null;\n      Garnish.$win.trigger('resize');\n    },\n\n    updateNameLabel: function () {\n      const name = this.$nameInput.val();\n      this.$nameLabel\n        .attr('title', name)\n        .html(\n          name\n            ? Craft.escapeHtml(name)\n            : '<em class=\"light\">' + Craft.t('app', '(blank)') + '</em>'\n        );\n    },\n\n    updateHandleLabel: function () {\n      const handle = this.$handleInput.val();\n      this.$handleLabel.attr('title', handle).html(Craft.escapeHtml(handle));\n    },\n\n    updateRequiredIcon: function () {\n      if (this.$requiredCheckbox.prop('checked')) {\n        this.$nameLabel.addClass('mci-required');\n      } else {\n        this.$nameLabel.removeClass('mci-required');\n      }\n    },\n\n    onTypeSelectChange: function () {\n      this.setFieldType(this.$typeSelect.val());\n    },\n\n    setFieldType: function (type) {\n      // Update the Translation Method settings\n      Craft.updateTranslationMethodSettings(\n        type,\n        this.$translationSettingsContainer\n      );\n\n      if (this.selectedFieldType) {\n        this.initializedFieldTypeSettings[this.selectedFieldType].detach();\n      }\n\n      this.selectedFieldType = type;\n      this.$typeSelect.val(type);\n\n      // Show a spinner\n      this.$typeSettingsContainer.html(\n        '<div class=\"zilch\"><div class=\"spinner\"></div></div>'\n      );\n\n      this.getFieldTypeSettings(type)\n        .then(({fresh, $settings, headHtml, bodyHtml}) => {\n          this.$typeSettingsContainer.html('').append($settings);\n          if (fresh) {\n            Craft.initUiElements($settings);\n            Craft.appendHeadHtml(headHtml);\n            Craft.appendBodyHtml(bodyHtml);\n          }\n\n          Garnish.$win.trigger('resize');\n        })\n        .catch(() => {\n          this.$typeSettingsContainer.html('');\n        });\n    },\n\n    getFieldTypeSettings: function (type) {\n      return new Promise((resolve, reject) => {\n        if (typeof this.initializedFieldTypeSettings[type] !== 'undefined') {\n          resolve({\n            fresh: false,\n            $settings: this.initializedFieldTypeSettings[type],\n          });\n          return;\n        }\n\n        this.configurator\n          .getFieldTypeSettingsHtml(type)\n          .then(({settingsHtml, headHtml, bodyHtml}) => {\n            settingsHtml = this.getParsedFieldTypeHtml(settingsHtml);\n            headHtml = this.getParsedFieldTypeHtml(headHtml);\n            bodyHtml = this.getParsedFieldTypeHtml(bodyHtml);\n            let $settings = $('<div/>').html(settingsHtml);\n            this.initializedFieldTypeSettings[type] = $settings;\n            resolve({\n              fresh: true,\n              $settings: $settings,\n              headHtml: headHtml,\n              bodyHtml: bodyHtml,\n            });\n          })\n          .catch($.noop);\n      });\n    },\n\n    getParsedFieldTypeHtml: function (html) {\n      if (typeof html === 'string') {\n        html = html.replace(\n          new RegExp(`__BLOCK_TYPE_${this.configurator.placeholderKey}__`, 'g'),\n          this.blockType.id\n        );\n        html = html.replace(\n          new RegExp(`__FIELD_${this.configurator.placeholderKey}__`, 'g'),\n          this.id\n        );\n      } else {\n        html = '';\n      }\n\n      return html;\n    },\n\n    getDefaultFieldSettings: function () {\n      var $container = $('<div/>', {\n        'data-id': this.id,\n      });\n\n      Craft.ui\n        .createTextField({\n          label: Craft.t('app', 'Name'),\n          id: this.inputIdPrefix + '-name',\n          name: this.inputNamePrefix + '[name]',\n        })\n        .appendTo($container);\n\n      Craft.ui\n        .createTextField({\n          label: Craft.t('app', 'Handle'),\n          id: this.inputIdPrefix + '-handle',\n          class: 'code',\n          name: this.inputNamePrefix + '[handle]',\n          maxlength: 64,\n          required: true,\n        })\n        .appendTo($container);\n\n      Craft.ui\n        .createTextareaField({\n          label: Craft.t('app', 'Instructions'),\n          id: this.inputIdPrefix + '-instructions',\n          class: 'nicetext',\n          name: this.inputNamePrefix + '[instructions]',\n        })\n        .appendTo($container);\n\n      let $fieldset = $('<fieldset/>').appendTo($container);\n\n      Craft.ui\n        .createCheckboxField({\n          label: Craft.t('app', 'This field is required'),\n          id: this.inputIdPrefix + '-required',\n          name: this.inputNamePrefix + '[required]',\n        })\n        .appendTo($fieldset);\n\n      Craft.ui\n        .createCheckboxField({\n          label: Craft.t('app', 'Use this field’s values as search keywords'),\n          id: this.inputIdPrefix + '-searchable',\n          name: this.inputNamePrefix + '[searchable]',\n          checked: false,\n        })\n        .appendTo($fieldset);\n\n      var fieldTypeOptions = [];\n\n      for (var i = 0; i < this.configurator.fieldTypeInfo.length; i++) {\n        fieldTypeOptions.push({\n          value: this.configurator.fieldTypeInfo[i].type,\n          label: this.configurator.fieldTypeInfo[i].name,\n        });\n      }\n\n      Craft.ui\n        .createSelectField({\n          label: Craft.t('app', 'Field Type'),\n          id: this.inputIdPrefix + '-type',\n          name: this.inputNamePrefix + '[type]',\n          options: fieldTypeOptions,\n          value: 'craft\\\\fields\\\\PlainText',\n        })\n        .appendTo($container);\n\n      if (Craft.isMultiSite) {\n        var $translationSettingsContainer = $('<div/>', {\n          id: this.inputIdPrefix + '-translation-settings',\n        }).appendTo($container);\n\n        Craft.ui\n          .createSelectField({\n            label: Craft.t('app', 'Translation Method'),\n            id: this.inputIdPrefix + '-translation-method',\n            name: this.inputNamePrefix + '[translationMethod]',\n            options: [],\n            value: 'none',\n            toggle: true,\n            targetPrefix: this.inputIdPrefix + '-translation-method-',\n          })\n          .appendTo($translationSettingsContainer);\n\n        var $translationKeyFormatContainer = $('<div/>', {\n          id: this.inputIdPrefix + '-translation-method-custom',\n          class: 'hidden',\n        }).appendTo($translationSettingsContainer);\n\n        Craft.ui\n          .createTextField({\n            label: Craft.t('app', 'Translation Key Format'),\n            id: this.inputIdPrefix + '-translation-key-format',\n            name: this.inputNamePrefix + '[translationKeyFormat]',\n          })\n          .appendTo($translationKeyFormatContainer);\n      }\n\n      $('<hr/>').appendTo($container);\n\n      $('<div/>', {\n        class: 'mc-fieldtype-settings',\n      }).appendTo($container);\n\n      $('<input/>', {\n        type: 'hidden',\n        id: this.inputIdPrefix + '-width',\n        name: this.inputNamePrefix + '[width]',\n        value: '100',\n      }).appendTo($container);\n\n      $('<hr/>').appendTo($container);\n\n      $('<a/>', {\n        class: 'error delete',\n        text: Craft.t('app', 'Delete'),\n      }).appendTo($container);\n\n      return $container;\n    },\n\n    confirmDelete: function () {\n      if (\n        confirm(Craft.t('app', 'Are you sure you want to delete this field?'))\n      ) {\n        this.selfDestruct();\n      }\n    },\n\n    selfDestruct: function () {\n      this.deselect();\n      this.$item.remove();\n      this.$fieldSettingsContainer.remove();\n\n      this.blockType.fields[this.id] = null;\n      delete this.blockType.fields[this.id];\n    },\n  });\n})(jQuery);\n"],"names":["$","Craft","MatrixConfigurator","Garnish","Base","extend","fieldTypeInfo","inputNamePrefix","fieldTypeSettingsNamespace","inputIdPrefix","placeholderKey","$container","$blockTypesColumnContainer","$fieldsColumnContainer","$fieldSettingsColumnContainer","$blockTypeItemsOuterContainer","$blockTypeItemsContainer","$fieldItemsContainer","$fieldSettingItemsContainer","$newBlockTypeBtn","$newFieldBtn","blockTypes","selectedBlockType","blockTypeSort","totalNewBlockTypes","_fieldTypeSettingsHtml","_cancelToken","_ignoreFailedRequest","init","this","formatInputId","children","$fieldItemsOuterContainer","$blockTypeItems","i","length","$item","id","data","BlockType","newMatch","match","parseInt","DragSort","handle","axis","addListener","getFieldTypeInfo","type","addBlockType","_this","getBlockTypeSettingsModal","blockTypeSettingsModal","show","onSubmit","name","t","appendTo","applySettings","select","addField","addItems","addFieldToSelectedBlockType","BlockTypeSettingsModal","getFieldTypeSettingsHtml","_this2","Promise","resolve","reject","cancel","requestAnimationFrame","axios","CancelToken","source","sendActionRequest","cancelToken","token","namespace","then","response","e","_e$response","cp","displayError","message","Modal","base","$form","$bod","setContainer","$body","$nameInputContainer","ui","createTextField","label","instructions","find","$nameInput","$nameErrorList","hide","$handleInputContainer","class","maxlength","$handleInput","$handleErrorList","$deleteBtn","$buttons","$cancelBtn","text","$submitBtn","handleGenerator","HandleGenerator","onFormSubmit","ev","preventDefault","visible","listening","updateTarget","val","trim","shake","onDeleteClick","confirm","onDelete","errors","_this3","stopListening","startListening","addClass","removeClass","displayErrors","isMobileBrowser","setTimeout","focus","attr","$input","$errorList","remove","configurator","$nameLabel","$handleLabel","$nameHiddenInput","$handleHiddenInput","$settingsBtn","$fieldSettingsContainer","fields","selectedField","fieldSort","totalNewFields","fieldSettings","_this4","$nameContainer","insertBefore","$fieldItems","$fieldItem","Field","onSortChange","$items","deselect","$win","trigger","showSettings","bind","selfDestruct","blockType","selectedFieldType","initializedFieldTypeSettings","$requiredCheckbox","$typeSelect","$translationSettingsContainer","$typeSettingsContainer","$widthInput","_this5","fieldTypeSettingsTemplates","isNew","getDefaultFieldSettings","setFieldType","SlidePicker","min","max","step","valueLabel","width","pct","concat","onChange","insertAfter","_this6","updateNameLabel","html","escapeHtml","updateHandleLabel","updateRequiredIcon","prop","onTypeSelectChange","_this7","updateTranslationMethodSettings","detach","getFieldTypeSettings","_ref","fresh","$settings","headHtml","bodyHtml","append","initUiElements","appendHeadHtml","appendBodyHtml","_this8","_ref2","settingsHtml","getParsedFieldTypeHtml","noop","replace","RegExp","required","createTextareaField","$fieldset","createCheckboxField","checked","fieldTypeOptions","push","value","createSelectField","options","isMultiSite","toggle","targetPrefix","$translationKeyFormatContainer","confirmDelete","jQuery"],"sourceRoot":""}